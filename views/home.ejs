<%- include('./partials/header') %>
<main>
  <h1 class="white-bg"><%= title %></h1>

    <% if (user) { %> 
      <form class="white-bg" method="POST"
        action="/tweets">
        <textarea class="white-bg" name="content"></textarea>
        <br>
        <ul><li id="test"><input id="tweet-btn" type="submit" value="Tweet"></li></ul>
      </form>
      <br> 
      <ul>
        <% tweets.forEach(function(t) { %>
          <% if (t.retweets.find(el => el.rt === true)) { %>
            <% t.retweets.forEach(function(r) { %>
            Retweet: <%= r.rtUserName %>
            <% }) %>
            <% } %>
          <a id="tweet-post" href="/tweets/<%= t._id %>">
            <strong class="white-bg"><li class="white-bg"><img alt="avatar" class="avatar" src="<%= t.userAvatar %>" referrerpolicy="no-referrer">
              <%= t.userName %>
                <%= t.createdAt.toLocaleDateString() %></a>
                <% if (user?._id.equals(t.user)) { %>
                  <a class="white-bg" href="/tweets/<%= t._id %>/edit">Edit</a>
              <form class="white-bg" action="/tweets/<%= t._id %>?_method=DELETE" method="POST">
                <input type="submit" value="Delete">
              </form></strong></li>
              <% }; %>
              <br>
                    <li><%= t.content %></li>
                    <br>
                    <br>
                    <br>
          <% if (!t.retweets.find(el => el.rt === true)) { %>
            <nav id="home-page-nav" class="white-bg">
              <a class="tweetnav-reply" href="/tweets/<%= t._id %>">Reply <%= t.replies.length %></a>
              <a class="tweetnav-rt" href="/retweets/<%= t._id %>">Retweet</a>
              <a class="tweetnav-like" href="/likes/<%= t._id %>">Like <%= t.likes.length %></a>
              <a class="white-bg" href="/bookmarks/<%= t._id %>">Bookmark</a>
            </nav>
            <% } %>
            <br>
            <br>
            <br>
            </a>
          <% }); %>
        </ul>
    <% } %>
</main>
<%- include('./partials/footer') %>